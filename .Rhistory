line = list(color = 'rgba(152, 0, 0, .8)',
width = 2))  %>%
add_trace(
r = as.numeric(as.vector(sum_df2[3,])),
theta = as.character(as.vector(names(sum_df2))),
name = 'People understanding'
) %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
p
# 'data_scrape/c35akk.csv'
getSentiment <- function(file_name) {
df <- read.csv(file_name,
sep="\t",
encoding="UTF-8",
stringsAsFactors=FALSE)
df$sentiment <- get_nrc_sentiment(df$body)
return(df)
}
createRadar <- function(df) {
df1 <- df %>%
select(sentiment)  %>%
do.call(data.frame, .) %>%
.[, -which(names(.) %in% c("sentiment.positive", "sentiment.negative"))]
names(df1) <- gsub("sentiment.", "", names(df1), fixed = TRUE)
sum_df <- df1 %>%
summarize_if(is.numeric, sum, na.rm=TRUE)
summed <- rowSums(sum_df)
sum_df <- sum_df/summed
sum_min <- min(sum_df[1,], na.rm = T)
sum_max <- max(sum_df[1,], na.rm = T)
sum_dim <- ncol(sum_df)
sum_df <- rbind(rep(sum_max, sum_dim), rep(sum_min, sum_dim), sum_df)
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = 'Irans bombing',
line = list(color = 'rgba(152, 0, 0, .8)',
width = 2))  %>%
# add_trace(
#   r = as.numeric(as.vector(sum_df2[3,])),
#   theta = as.character(as.vector(names(sum_df2))),
#   name = 'People understanding'
# ) %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
return (p)
}
df_5 <- getSentiment('data_scrape/c35akk.csv')
library(syuzhet)
library(dplyr)
library(plotly)
df_5 <- getSentiment('data_scrape/c35akk.csv')
createRadar(df_5)
createRadar <- function(df, title) {
df1 <- df %>%
select(sentiment)  %>%
do.call(data.frame, .) %>%
.[, -which(names(.) %in% c("sentiment.positive", "sentiment.negative"))]
names(df1) <- gsub("sentiment.", "", names(df1), fixed = TRUE)
sum_df <- df1 %>%
summarize_if(is.numeric, sum, na.rm=TRUE)
summed <- rowSums(sum_df)
sum_df <- sum_df/summed
sum_min <- min(sum_df[1,], na.rm = T)
sum_max <- max(sum_df[1,], na.rm = T)
sum_dim <- ncol(sum_df)
sum_df <- rbind(rep(sum_max, sum_dim), rep(sum_min, sum_dim), sum_df)
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = title,
line = list(color = 'rgba(152, 0, 0, .8)',
width = 0))  %>%
# add_trace(
#   r = as.numeric(as.vector(sum_df2[3,])),
#   theta = as.character(as.vector(names(sum_df2))),
#   name = 'People understanding'
# ) %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
return (p)
}
createRadar(df_5, "Irans stuff")
createRadar <- function(df, title) {
df1 <- df %>%
select(sentiment)  %>%
do.call(data.frame, .) %>%
.[, -which(names(.) %in% c("sentiment.positive", "sentiment.negative"))]
names(df1) <- gsub("sentiment.", "", names(df1), fixed = TRUE)
sum_df <- df1 %>%
summarize_if(is.numeric, sum, na.rm=TRUE)
summed <- rowSums(sum_df)
sum_df <- sum_df/summed
sum_min <- min(sum_df[1,], na.rm = T)
sum_max <- max(sum_df[1,], na.rm = T)
sum_dim <- ncol(sum_df)
sum_df <- rbind(rep(sum_max, sum_dim), rep(sum_min, sum_dim), sum_df)
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines+markers"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = title,
line = list(color = 'rgba(152, 0, 0, .8)',
width = 0))  %>%
# add_trace(
#   r = as.numeric(as.vector(sum_df2[3,])),
#   theta = as.character(as.vector(names(sum_df2))),
#   name = 'People understanding'
# ) %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
return (p)
}
createRadar(df_5, "Irans stuff")
createRadar <- function(df, title) {
df1 <- df %>%
select(sentiment)  %>%
do.call(data.frame, .) %>%
.[, -which(names(.) %in% c("sentiment.positive", "sentiment.negative"))]
names(df1) <- gsub("sentiment.", "", names(df1), fixed = TRUE)
sum_df <- df1 %>%
summarize_if(is.numeric, sum, na.rm=TRUE)
summed <- rowSums(sum_df)
sum_df <- sum_df/summed
sum_min <- min(sum_df[1,], na.rm = T)
sum_max <- max(sum_df[1,], na.rm = T)
sum_dim <- ncol(sum_df)
sum_df <- rbind(rep(sum_max, sum_dim), rep(sum_min, sum_dim), sum_df)
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines+markers"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = title,
line = list(color = 'rgba(152, 0, 0, .8)',
width = 0.5))  %>%
# add_trace(
#   r = as.numeric(as.vector(sum_df2[3,])),
#   theta = as.character(as.vector(names(sum_df2))),
#   name = 'People understanding'
# ) %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
return (p)
}
createRadar(df_5, "Irans stuff")
createRadar <- function(df, title) {
df1 <- df %>%
select(sentiment)  %>%
do.call(data.frame, .) %>%
.[, -which(names(.) %in% c("sentiment.positive", "sentiment.negative"))]
names(df1) <- gsub("sentiment.", "", names(df1), fixed = TRUE)
sum_df <- df1 %>%
summarize_if(is.numeric, sum, na.rm=TRUE)
summed <- rowSums(sum_df)
sum_df <- sum_df/summed
sum_min <- min(sum_df[1,], na.rm = T)
sum_max <- max(sum_df[1,], na.rm = T)
sum_dim <- ncol(sum_df)
sum_df <- rbind(rep(sum_max, sum_dim), rep(sum_min, sum_dim), sum_df)
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines+markers"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = title,
line = list(color = 'rgba(51, 40, 155, .8)',
width = 0.5))  %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
return (p)
}
createRadar(df_5, "Irans stuff")
createRadar <- function(df, title) {
df1 <- df %>%
select(sentiment)  %>%
do.call(data.frame, .) %>%
.[, -which(names(.) %in% c("sentiment.positive", "sentiment.negative"))]
names(df1) <- gsub("sentiment.", "", names(df1), fixed = TRUE)
sum_df <- df1 %>%
summarize_if(is.numeric, sum, na.rm=TRUE)
summed <- rowSums(sum_df)
sum_df <- sum_df/summed
sum_min <- min(sum_df[1,], na.rm = T)
sum_max <- max(sum_df[1,], na.rm = T)
sum_dim <- ncol(sum_df)
sum_df <- rbind(rep(sum_max, sum_dim), rep(sum_min, sum_dim), sum_df)
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines+markers"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = title,
line = list(color = 'rgba(51, 40, 155, .8)',
width = 0.5),
fillcolor = 'rgba(51, 40, 155, 0.3)')  %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
return (p)
}
createRadar(df_5, "Irans stuff")
createRadar <- function(df, title) {
df1 <- df %>%
select(sentiment)  %>%
do.call(data.frame, .) %>%
.[, -which(names(.) %in% c("sentiment.positive", "sentiment.negative"))]
names(df1) <- gsub("sentiment.", "", names(df1), fixed = TRUE)
sum_df <- df1 %>%
summarize_if(is.numeric, sum, na.rm=TRUE)
summed <- rowSums(sum_df)
sum_df <- sum_df/summed
sum_min <- min(sum_df[1,], na.rm = T)
sum_max <- max(sum_df[1,], na.rm = T)
sum_dim <- ncol(sum_df)
sum_df <- rbind(rep(sum_max, sum_dim), rep(sum_min, sum_dim), sum_df)
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = title,
line = list(color = 'rgba(51, 40, 155, .8)',
width = 0.6),
fillcolor = 'rgba(51, 40, 155, 0.5)')  %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
return (p)
}
createRadar(df_5, "Irans stuff")
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = title,
line = list(color = 'rgba(51, 40, 155, .8)',
width = 0.6),
fillcolor = 'rgba(51, 40, 155, 0.5)',
marker = list(
color = 'rgb(51, 40, 155)',
size = 60
) ) %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
createRadar(df_5, "Irans stuff")
createRadar <- function(df, title) {
df1 <- df %>%
select(sentiment)  %>%
do.call(data.frame, .) %>%
.[, -which(names(.) %in% c("sentiment.positive", "sentiment.negative"))]
names(df1) <- gsub("sentiment.", "", names(df1), fixed = TRUE)
sum_df <- df1 %>%
summarize_if(is.numeric, sum, na.rm=TRUE)
summed <- rowSums(sum_df)
sum_df <- sum_df/summed
sum_min <- min(sum_df[1,], na.rm = T)
sum_max <- max(sum_df[1,], na.rm = T)
sum_dim <- ncol(sum_df)
sum_df <- rbind(rep(sum_max, sum_dim), rep(sum_min, sum_dim), sum_df)
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = title,
line = list(color = 'rgba(51, 40, 155, .8)',
width = 0.6),
fillcolor = 'rgba(51, 40, 155, 0.5)',
marker = list(
color = 'rgb(51, 40, 155)',
size = 130
) ) %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
return (p)
}
createRadar(df_5, "Irans stuff")
createRadar <- function(df, title) {
df1 <- df %>%
select(sentiment)  %>%
do.call(data.frame, .) %>%
.[, -which(names(.) %in% c("sentiment.positive", "sentiment.negative"))]
names(df1) <- gsub("sentiment.", "", names(df1), fixed = TRUE)
sum_df <- df1 %>%
summarize_if(is.numeric, sum, na.rm=TRUE)
summed <- rowSums(sum_df)
sum_df <- sum_df/summed
sum_min <- min(sum_df[1,], na.rm = T)
sum_max <- max(sum_df[1,], na.rm = T)
sum_dim <- ncol(sum_df)
sum_df <- rbind(rep(sum_max, sum_dim), rep(sum_min, sum_dim), sum_df)
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = title,
line = list(color = 'rgba(51, 40, 155, .8)',
width = 0.6),
fillcolor = 'rgba(51, 40, 155, 0.5)',
marker = list(
color = 'rgb(51, 40, 155)',
size = 20
) ) %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
return (p)
}
createRadar(df_5, "Irans stuff")
createRadar <- function(df, title) {
df1 <- df %>%
select(sentiment)  %>%
do.call(data.frame, .) %>%
.[, -which(names(.) %in% c("sentiment.positive", "sentiment.negative"))]
names(df1) <- gsub("sentiment.", "", names(df1), fixed = TRUE)
sum_df <- df1 %>%
summarize_if(is.numeric, sum, na.rm=TRUE)
summed <- rowSums(sum_df)
sum_df <- sum_df/summed
sum_min <- min(sum_df[1,], na.rm = T)
sum_max <- max(sum_df[1,], na.rm = T)
sum_dim <- ncol(sum_df)
sum_df <- rbind(rep(sum_max, sum_dim), rep(sum_min, sum_dim), sum_df)
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines+markers"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = title,
line = list(color = 'rgba(51, 40, 155, .8)',
width = 0.6),
fillcolor = 'rgba(51, 40, 155, 0.5)',
marker = list(
color = 'rgb(51, 40, 155)',
size = 3
) ) %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
return (p)
}
createRadar(df_5, "Irans stuff")
createRadar <- function(df, title) {
df1 <- df %>%
select(sentiment)  %>%
do.call(data.frame, .) %>%
.[, -which(names(.) %in% c("sentiment.positive", "sentiment.negative"))]
names(df1) <- gsub("sentiment.", "", names(df1), fixed = TRUE)
sum_df <- df1 %>%
summarize_if(is.numeric, sum, na.rm=TRUE)
summed <- rowSums(sum_df)
sum_df <- sum_df/summed
sum_min <- min(sum_df[1,], na.rm = T)
sum_max <- max(sum_df[1,], na.rm = T)
sum_dim <- ncol(sum_df)
sum_df <- rbind(rep(sum_max, sum_dim), rep(sum_min, sum_dim), sum_df)
p <- plot_ly(
type = 'scatterpolar',
fill = 'toself',
mode = "lines+markers"
) %>%
add_trace(
r = as.numeric(as.vector(sum_df[3,])),
theta = as.character(as.vector(names(sum_df))),
name = title,
line = list(color = 'rgba(51, 40, 155, .8)',
width = 0.6),
fillcolor = 'rgba(51, 40, 155, 0.5)',
marker = list(
color = 'rgb(51, 40, 155)',
size = 5
) ) %>%
layout(
polar = list(
radialaxis = list(
visible = T,
range = c(min(sum_min, sum2_min), max(sum_max, sum2_max) + 0.1)
)
)
)
return (p)
}
createRadar(df_5, "Irans stuff")
# 2 sposob
radarchart(sum_df  , axistype=1 ,
#custom polygon
pcol=rgb(0.2,0.5,0.5,0.9) , pfcol=rgb(0.2,0.5,0.5,0.5) , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", cglwd=0.8,
#custom labels
vlcex=0.8
)
library(syuzhet)
# 2 sposob
radarchart(sum_df  , axistype=1 ,
#custom polygon
pcol=rgb(0.2,0.5,0.5,0.9) , pfcol=rgb(0.2,0.5,0.5,0.5) , plwd=4 ,
#custom the grid
cglcol="grey", cglty=1, axislabcol="grey", cglwd=0.8,
#custom labels
vlcex=0.8
)
